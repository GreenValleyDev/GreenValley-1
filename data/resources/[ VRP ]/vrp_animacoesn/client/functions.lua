local a,b,c=false,false,false;local d,e={},nil;Citizen.CreateThread(function()local f=Config.StopAnimControl;while true do Wait(5)if a or b or c then if IsControlJustReleased(0,f)then ClearAll()end else Wait(200)end end end)function RemoveProps(g)local h={}for i,j in pairs(d)do if DoesEntityExist(j)then local k=NetworkGetNetworkIdFromEntity(j)table.insert(h,k)end end;if#h>0 then TriggerServerEvent('ajnasummer:deleteEntity',h)end;b=false end;function ClearAll()local g=PlayerPedId()if b then RemoveProps(g)end;if c then FreezeEntityPosition(g,false)if e then local l=GetEntityCoords(g)if#(l-e)<=3 then SetEntityCoordsNoOffset(g,e.x,e.y,e.z,false,false,false)e=nil end end;ClearPedTasks(g)c=false end;if a then ClearPedSecondaryTask(g)a=false end end;function PlayAnim(m)local g=PlayerPedId()LoadAnimDict(m.dict)TaskPlayAnim(g,m.dict,m.anim,3.0,-3.0,-1,GetOrElse(m.flag,0),0.0,false,false,false)RemoveAnimDict(m.dict)a=true end;function PlayPropAnim(m)local g=PlayerPedId()local l=GetEntityCoords(g)local n=GetOrElse(m.offX,0.0)local o=GetOrElse(m.offY,0.0)local p=GetOrElse(m.offZ,0.0)local q=GetOrElse(m.rotX,0.0)local r=GetOrElse(m.rotY,0.0)local s=GetOrElse(m.rotZ,0.0)if b then RemoveProps(g)end;LoadAnimDict(m.dict)LoadModel(m.prop)local j=CreateObject(m.prop,l.x,l.y,l.z,true,true,true)AttachEntityToEntity(j,g,GetPedBoneIndex(g,m.bone),n,o,p,q,r,s,true,true,false,true,1,true)SetModelAsNoLongerNeeded(m.prop)table.insert(d,j)b=true;TaskPlayAnim(g,m.dict,m.anim,3.0,-3.0,-1,GetOrElse(m.flag,51),0.0,false,false,false)RemoveAnimDict(m.dict)end;function PlaySitAnim(m)local g=PlayerPedId()local n=GetOrElse(m.offX,0.0)local o=GetOrElse(m.offY,0.0)local p=GetOrElse(m.offZ,0.0)if c then FreezeEntityPosition(g,false)if e then local l=GetEntityCoords(g)if#(l-e)<=3 then SetEntityCoordsNoOffset(g,e.x,e.y,e.z,false,false,false)e=nil end end end;local t=GetOffsetFromEntityInWorldCoords(g,n,o,p)e=GetEntityCoords(g)if m.type=='sitanim'then LoadAnimDict(m.dict)SetEntityCoordsNoOffset(g,t.x,t.y,t.z,false,false,false)FreezeEntityPosition(g,true)Wait(5)TaskPlayAnim(g,m.dict,m.anim,3.0,-1.0,-1,GetOrElse(m.flag,1),0,0,0,0)RemoveAnimDict(m.dict)TrackFreeze(g,e)elseif m.type=='sitscenario'then TaskStartScenarioAtPosition(g,m.anim,t.x,t.y,t.z,GetEntityHeading(g),0,true,false)end;c=true end;function TrackFreeze(g,u)Citizen.CreateThread(function()local v=u;while c do Wait(1000)local l=GetEntityCoords(g)if#(l-v)>3.0 then FreezeEntityPosition(g,false)c=false end end end)end;AddEventHandler('onResourceStop',function(w)if w~=GetCurrentResourceName()then return end;if c then local g=PlayerPedId()local x=GetOffsetFromEntityInWorldCoords(g,0.0,0.0,1.0)FreezeEntityPosition(g,false)SetEntityCoordsNoOffset(g,x.x,x.y,x.z,false,false,false)ClearPedTasksImmediately(g)c,e=false,nil end end)